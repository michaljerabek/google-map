!function(t){window.GoogleMaps=function(){var e=[],i=!1,o=t.Deferred(),s=function(t){return t instanceof GoogleMap&&(e.push(t),i&&t.init(),t)},n=function(){e.forEach(function(t){t.init()}),i=!0};return window.googleMapsInit=function(){"function"==typeof window.GoogleMaps.onInit&&window.GoogleMaps.onInit(e),o.resolve(e),o.then(n)},{addMap:s,promise:function(){return o.promise()}}}()}(jQuery),function(t){var e={el:"#map",zoom:14,controls:!1,styles:[],centerToLocationOnResize:0,fitBoundsOnResize:0},i=window.GoogleMap=function i(o){if("object"!=typeof o)throw"Options required.";this.options=t.extend({},e,o),this.options.el||(this.options.el=i.DEFAULTS.el),this.options.zoom||(this.options.zoom=i.DEFAULTS.zoom),this.options.styles||(this.options.styles=i.DEFAULTS.styles),this.el=null,this.$el=null,this.map=null,this._noCoordsOnInit=!this.options.coords,this._animations={},this._$animEl=t("<div></div>"),this._idHTMLCounter=0,this._idMarkerCounter=0,this._idInfoCounter=0,this._markers=[],this._markersDefers={},this._infos=[],this._infosDefers={},this._htmls=[],this._htmlsDefers={},this.markers={},this.groupedMarkers={},this.infos={},this.HTMLs={},this.markerId=null,this.infoId=null,this.HTMLId=null,this._defer=t.Deferred(),GoogleMaps.addMap(this)},o=function(t){switch(t){case"HTML":return this.HTMLs[++this._idHTMLCounter]?o.call(this,t):this._idHTMLCounter;case"Marker":return this.markers[++this._idMarkerCounter]?o.call(this,t):this._idMarkerCounter;case"Info":return this.infos[++this._idInfoCounter]?o.call(this,t):this._idInfoCounter}},s=function(){t.each(this.infos,function(t,e){e.close()})},n=function(t,e){var i=!1,o=this;google.maps.event.addListener(e,"touchend",function(){i=!0,s.call(o),t.open(this.map,this)}),google.maps.event.addListener(e,"click",function(){return i?void(i=!1):(s.call(o),void t.open(this.map,this))})};i.DEFAULTS=e,i.STYLES={},i.STYLES.empty=function(){return[]},i.prototype.init=function(){this.bounds=new google.maps.LatLngBounds,this.$el=this.options.el.jquery?this.options.el:t(this.options.el),this.el=this.$el[0];var e={zoom:this.options.zoom};this.options.coords instanceof google.maps.LatLng?e.location=this.options.coords:this.options.coords&&(e.location=new google.maps.LatLng(this.options.coords[0],this.options.coords[1])),this.options.styles instanceof GoogleMapStyle?e.styles=this.options.styles.getStyles():e.styles=this.options.styles,e.center=e.location,this.options.controls||i.DEFAULTS.controls||(e.zoomControl=!1,e.mapTypeControl=!1,e.scaleControl=!1,e.streetViewControl=!1,e.rotateControl=!1,e.fullscreenControl=!1),this.options.options&&(e=t.extend({},e,this.options.options)),this.map=new google.maps.Map(this.el,e),this.options.centerToLocationOnResize&&this.initCenterToLocationOnResize(this.options.centerToLocationOnResize),this.options.fitBoundsOnResize&&this.initFitBoundsOnResize(this.options.fitBoundsOnResize),this.initialized=!0,(this.options.icon||this.options.addMarker)&&(this.markerId=o.call(this,"Marker"),this.options.info&&(this.infoId=o.call(this,"Info")),this.addMarker({coords:e.location,icon:this.options.icon,info:this.options.info,infoId:this.options.infoId,id:this.markerId})),this.options.markers&&this.options.markers.forEach(this.addMarker.bind(this)),this.options.html&&(this.options.html instanceof Array?this.options.html.forEach(this.addHTML.bind(this)):(this.HTMLId=o.call(this,"HTML"),this.addHTML({html:this.options.html,id:this.HTMLId}))),this._markers.forEach(this.addMarker.bind(this)),this._infos.forEach(this.addInfo.bind(this)),this._htmls.forEach(this.addHTML.bind(this)),this._noCoordsOnInit&&this.fitBounds(),"function"==typeof this.options.onInit&&this.options.onInit.call(this),this._defer.resolve(this,this.markers[this.markerId],this.markerId)},i.prototype.promise=function(){return this._defer.promise()},i.prototype.addMarker=function(e){e=e||{};var i=e.id||o.call(this,"Marker"),s=this._markersDefers[e.id]||t.Deferred();if(!this.initialized)return e.id=e.id||i,this._markers.push(e),this._markersDefers[e.id]=s,s.promise();!e.coords||e.coords instanceof google.maps.LatLng||(e.coords=new google.maps.LatLng(e.coords[0],e.coords[1]));var n={position:e.coords||this.map.location,map:this.map,icon:e.icon||this.options.icon};e.options&&(n=t.extend({},n,e.options));var r=new google.maps.Marker(n);return e.info&&this.addInfo({content:e.info,marker:r,id:e.infoId}),this.markers[i]=r,e.group=e.group||"no-group",this.groupedMarkers[e.group]=this.groupedMarkers[e.group]||{},this.groupedMarkers[e.group][i]=r,this.bounds.extend(r.position),s.resolve(this,r,i),s.promise()},i.prototype.getMarker=function(t){return this.markers[t]||null},i.prototype.addInfo=function(e){e=e||{};var i=e.id||o.call(this,"Info"),s=this._infosDefers[e.id]||t.Deferred();if(!this.initialized)return e.id=e.id||i,this._infos.push(e),this._infosDefers[e.id]=s,s.promise();e.marker=e.marker||this.markers[this.markers.length-1];var r={content:e.content};e.options&&(r=t.extend({},r,e.options));var a=new google.maps.InfoWindow(r);return n.call(this,a,e.marker),this.infos[i]=a,s.resolve(this,a,i),s.promise()},i.prototype.getInfo=function(t){return this.infos[t]||null},i.prototype.addHTML=function(e){e=e||{};var i=e.id||o.call(this,"HTML"),s=this._htmlsDefers[e.id]||t.Deferred();if(!this.initialized)return"string"==typeof e?e={html:e,id:i}:e.id=e.id||i,this._htmls.push(e),this._htmlsDefers[e.id]=s,s.promise();var n,r="string"==typeof e||e instanceof HTMLElement?e:e.html,a="object"!=typeof e||e instanceof HTMLElement?null:e.coords,p="object"!=typeof e||e instanceof HTMLElement?null:e.draw,h=function(){s.resolve(this,n,i)}.bind(this);return n=new GoogleMapHTMLOverlay(this.map,r,a,p,h),this.HTMLs[i]=n,s.promise()},i.prototype.getHTML=function(t){return this.HTMLs[t]||null},i.getStyles=function(t,e){var o;return o=i.STYLES[t]?new GoogleMapStyle(i.STYLES[t]()):new GoogleMapStyle(i.STYLES.empty()),"function"==typeof e&&e.call(o),o},i.prototype.initCenterToLocationOnResize=function(t){if(!this.resizeCenterToLocationInitialized){var e="number"==typeof t,i=this;google.maps.event.addDomListener(window,"resize",function(){return e?(clearTimeout(e),void(e=setTimeout(i.centerToLocation.bind(i),t))):void i.centerToLocation()}),this.resizeCenterToLocationInitialized=!0}},i.prototype.initFitBoundsOnResize=function(t){if(!this.resizeFitBoundsInitialized){var e="number"==typeof t,i=this;google.maps.event.addDomListener(window,"resize",function(){return e?(clearTimeout(e),void(e=setTimeout(i.fitBounds.bind(i),t))):void i.fitBounds()}),this.resizeFitBoundsInitialized=!0}},i.prototype.centerToLocation=function(){this.map.setCenter(this.map.location)},i.prototype.fitBounds=function(){this.map.fitBounds(this.bounds)},i.prototype.center=function(t){"string"!=typeof t&&"number"!=typeof t||(t=this.getMarker(t)||this.getHTML(t)),t instanceof Array&&(t=new google.maps.LatLng(t[0],t[1])),t instanceof google.maps.LatLng?this.map.setCenter(t):t&&t.position?this.map.setCenter(t.position):this.centerToLocation()},i.prototype.animate=function(t,e,i){if("string"!=typeof t&&"number"!=typeof t||(t=this.getMarker(t)),t){var o=t.getPosition().toString();clearTimeout(this._animations[o]),null!==t.getAnimation()&&t.setAnimation(null),t.setAnimation(i||google.maps.Animation.BOUNCE),this._animations[o]=setTimeout(t.setAnimation.bind(t,null),e||2800)}},i.prototype.animateGroup=function(e,i,o){t.each(this.groupedMarkers[e],function(t,e){this.animate(e,i,o)}.bind(this))},i.prototype.opacity=function(t,e,i,o){if("string"!=typeof t&&"number"!=typeof t||(t=this.getMarker(t)),t&&i){var s;return void this._$animEl.stop(!0,!0).animate({opacity:e},{duration:i,progress:function(i,o){"number"!=typeof s&&(s="number"==typeof t.getOpacity()?t.getOpacity():t.getVisible()?1:0);var n=s-e;n&&t.setOpacity(s-n*o),!t.getVisible()&&e>0&&t.setVisible(!0),0===e&&1===o&&t.setVisible(!1)},easing:o||"linear"})}t.setOpacity(e),t.setVisible(e>0)},i.prototype.groupOpacity=function(e,i,o,s){if(o){var n=[];return void this._$animEl.stop(!0,!0).animate({opacity:i},{duration:o,progress:function(o,s){t.each(this.groupedMarkers[e],function(t,e){"number"!=typeof n[t]&&(n[t]="number"==typeof e.getOpacity()?e.getOpacity():e.getVisible()?1:0);var o=n[t]-i;o&&e.setOpacity(n[t]-o*s),!e.getVisible()&&i>0&&e.setVisible(!0),0===i&&1===s&&e.setVisible(!1)}.bind(this))}.bind(this),easing:s||"linear"})}t.each(this.groupedMarkers[e],function(t,e){e.setOpacity(i),e.setVisible(i>0)}.bind(this))},i.prototype.show=function(t,e,i){this.opacity(t,1,e,i)},i.prototype.showGroup=function(t,e,i){this.groupOpacity(t,1,e,i)},i.prototype.hide=function(t,e,i){this.opacity(t,0,e,i)},i.prototype.hideGroup=function(t,e,i){this.groupOpacity(t,0,e,i)},i.prototype.highlight=function(e,i,o,s){if(o=o||0,"string"!=typeof e&&"number"!=typeof e||(e=this.getMarker(e)),i){var n=[];return void this._$animEl.stop(!0).animate({opacity:o},{duration:i,progress:function(i,s){t.each(this.markers,function(t,i){"number"!=typeof n[t]&&(n[t]="number"==typeof i.getOpacity()?i.getOpacity():i.getVisible()?1:0);var r=i!==e&&e!==!1?o:1,a=n[t]-r;a&&i.setOpacity(n[t]-a*s),0===r&&1===s&&i.setVisible(!1),r>0&&!i.getVisible()&&i.setVisible(!0)})}.bind(this),easing:s||"linear"})}t.each(this.markers,function(t,i){o?(i.setOpacity(i===e||e===!1?1:o),(i===e||e===!1||o>0)&&i.setVisible(!0),i!==e&&e===!1&&0===o&&i.setVisible(!1)):(i!==e&&e!==!1||i.setOpacity(1),i.setVisible(i===e||e===!1))})},i.prototype.highlightGroup=function(e,i,o,s){if(o=o||0,i){var n={};return void this._$animEl.stop(!0).animate({opacity:o},{duration:i,progress:function(i,s){t.each(this.groupedMarkers,function(i){"object"!=typeof n[i]&&(n[i]=[]),t.each(this.groupedMarkers[i],function(t,r){"number"!=typeof n[i][t]&&(n[i][t]="number"==typeof r.getOpacity()?r.getOpacity():r.getVisible()?1:0);var a=i!==e&&e!==!1?o:1,p=n[i][t]-a;p&&r.setOpacity(n[i][t]-p*s),0===a&&1===s&&r.setVisible(!1),a>0&&!r.getVisible()&&r.setVisible(!0)}.bind(this))}.bind(this))}.bind(this),easing:s||"linear"})}t.each(this.groupedMarkers,function(i){t.each(this.groupedMarkers[i],function(t,s){o?(s.setOpacity(i===e||e===!1?1:o),(i===e||e===!1||o>0)&&s.setVisible(!0),i!==e&&e===!1&&0===o&&s.setVisible(!1)):(i!==e&&e!==!1||s.setOpacity(1),s.setVisible(i===e||e===!1))}.bind(this))}.bind(this))},i.prototype.on=function(t,e){return this.map.addListener(t,e)},i.prototype.off=function(t){this.map.removeListener(t)},i.prototype.onMarker=function(t,e,i){return"string"!=typeof t&&"number"!=typeof t||(t=this.getMarker(t)),google.maps.event.addListener(t,e,i)},i.prototype.offMarker=function(t){google.maps.event.removeListener(t)}}(jQuery),function(t){var e=window.GoogleMapHTMLOverlay=function(t,e,i,o,s){this.html=e,this.$el=null,this.el=null,this.map=t,this._resolve=s,o&&(this.draw=o),i instanceof google.maps.LatLng?this.position=i:i instanceof google.maps.Marker?this.position=i.position:i instanceof Array?this.position=new google.maps.LatLng(i[0],i[1]):this.position=this.map.location,this.setMap(t)};GoogleMaps.promise().then(function(){e.prototype=new google.maps.OverlayView,e.prototype.onAdd=function(){var e=this.getPanes();this.$el=t("<div></div>"),this.$el.css("position","absolute").html(this.html).appendTo(e.overlayMouseTarget),this.el=this.$el[0],this._resolve()},e.prototype.draw=function(){var t=this.getProjection();this.pxPosition=t.fromLatLngToDivPixel(this.position),this.size={width:this.el.offsetWidth||(this.size?this.size.width:0),height:this.el.offsetHeight||(this.size?this.size.height:0)},this.size.width&&this.size.height&&(this.el.style.left=this.pxPosition.x-this.size.width/2+"px",this.el.style.top=this.pxPosition.y-this.size.height+"px")},e.prototype.onRemove=function(){this.$el.remove(),this.$el=null,this.el=null},e.prototype.show=function(t){var e=Array.prototype.slice.call(arguments);return t===!1&&(e[0]=0),this.$el.fadeIn.apply(this.$el,e)},e.prototype.hide=function(t){var e=Array.prototype.slice.call(arguments);return t===!1&&(e[0]=0),this.$el.fadeOut.apply(this.$el,e)},e.prototype.animate=function(){return this.$el.animate.apply(this.$el,arguments)},e.prototype.css=function(){return this.$el.css.apply(this.$el,arguments)},e.prototype.find=function(){return this.$el.find.apply(this.$el,arguments)},e.prototype.addClass=function(){return this.$el.addClass.apply(this.$el,arguments)},e.prototype.removeClass=function(){return this.$el.removeClass.apply(this.$el,arguments)},e.prototype.hasClass=function(){return this.$el.hasClass.apply(this.$el,arguments)}})}(jQuery),function(t){var e=window.GoogleMapStyle=function(t){this.styles=t||[]};e.prototype.set=function(t,e,i,o){var s=!1;this.each(function(o){if(!(o.featureType!==t&&(o.featureType||t)||o.elementType!==e&&(o.elementType||e)))return o.stylers=this.toStylers(i),s=!0,!1}),s||this.styles.push({featureType:t,elementType:e,stylers:this.toStylers(i)}),o&&this.findSubtypes(t,e).forEach(function(t){this.unset(t.featureType,t.elementType)}.bind(this))},e.prototype.all=function(t,e,i,o){this.each(function(o){o.featureType!==t&&t&&"all"!==t&&(!o.featureType||0!==o.featureType.indexOf(t+"."))||o.elementType!==e&&(o.elementType||e)||(o.stylers=this.toStylers(i))}),o&&this.findSubtypes(t,e).forEach(function(t){this.unset(t.featureType,t.elementType)}.bind(this))},e.prototype.unset=function(t,e,i){this.each(function(i,o){if(!(i.featureType!==t&&(i.featureType||t)||i.elementType!==e&&(i.elementType||e)))return this.styles.splice(o,1),!1}),i&&this.findSubtypes(t,e).forEach(function(t){this.unset(t.featureType,t.elementType)}.bind(this))},e.prototype.add=function(e,i,o,s){var n=!1;this.each(function(s){if(!(s.featureType!==e&&(s.featureType||e)||s.elementType!==i&&(s.elementType||i)))return t.each(o,function(e,i){var o=!1;if(t.each(s.stylers,function(t,n){if("undefined"!=typeof n[e])return s.stylers[t][e]=i,o=!0,!1}),!o){var n={};n[e]=i,s.stylers=s.stylers||[],s.stylers.push(n)}}),n=!0,!1}),n||this.set(e,i,o),s&&this.findSubtypes(e,i).forEach(function(t){this.remove(t.featureType,t.elementType,Object.keys(o))}.bind(this))},e.prototype.remove=function(e,i,o,s){o="string"==typeof o?[o]:o;var n=!1;this.each(function(s){if(!(s.featureType!==e&&(s.featureType||e)||s.elementType!==i&&(s.elementType||i)))return o.forEach(function(e){t.each(s.stylers,function(t,i){if("undefined"!=typeof i[e])return s.stylers.splice(t,1),!1})}.bind(this)),s.stylers.length||this.unset(e,i),n=!0,!1}),n||this.unset(e,i,s),s&&this.findSubtypes(e,i).forEach(function(t){this.remove(t.featureType,t.elementType,o)}.bind(this))},e.prototype.toStylers=function(e){var i=[];return t.each(e,function(t,e){var o={};o[t]=e,i.push(o)}),i},e.prototype.findSubtypes=function(t,e){var i=[],o=t?t+".":null,s=e?e+".":null;return this.each(function(n){var r=!1,a=!!n.featureType,p=!!n.elementType,h=n.featureType===t,l=n.elementType===e,u=a&&(0===n.featureType.indexOf(o)||"all"===t&&"all"!==n.featureType),f=p&&(0===n.elementType.indexOf(s)||"all"===e&&"all"!==n.elementType);(!a&&!t||a&&(h||u))&&p&&f&&(r=i.push(n)),r||e||!(!p||a&&u)||a&&u&&(r=i.push(n)),!r&&a&&p&&((h&&f||u&&l||f&&u)&&(r=i.push(n)),!r&&h&&!e&&p&&(r=i.push(n)))}),i},e.prototype.each=function(t,e){return t===!0?void this.getStyles().forEach(function(t){t.stylers&&t.stylers.forEach(function(i){e.call(this,i,t.featureType,t.elementType)})}):void this.getStyles().forEach(t.bind(this))},e.prototype.getStyles=function(){return this.styles}}(jQuery);
